---
layout: post
title:  "中国剩余定理"
date:   2013-11-12 12:00:00
tags:	tech
myTag:	algorithm

---

# 中国剩余定理

前言: 好像好久没有更新博客了~ 主要是自己不勤快和懒惰，今后要多写博客，好好提升自己。今天学习到的东西是数论中一个重要定理，名字也很特别叫`中国剩余定理`。

-------------------------------

中国剩余定理又叫做孙子定理。它的应用场景我们一定都很熟悉，在小学的奥数题目经常出现，例如：

***"一个正整数M，除以3余2，除以5余3，除以7余2，究竟M最小为多少？"***

小时候我做这种题，都是靠猜一下，猜一下，猜出答案，没有什么技巧，但是其实应用中国剩余定理即可以解决这个问题。

现在我们把问题一般化：

***"给定一个正整数M，当M/A余a，当M/B余b，...， 当M/Z余z时，M最小为多少？(这里A, B, ..., Z, a, b, ..., z为任意除了0和1的正整数，因为对于0没有意义，对于1，中国剩余定理没有讨论和计算的价值)"***

## 解释

我们假定A, B, ..., Z都是不同的素数，那么对于B\*C\*D\*...\*Z不能被A整除。有等差数列(B\*C\*D\*...\*Z), (B\*C\*D\*...\*Z)\*2, ..., (B\*C\*D\*...\*Z)\*N，从中取连续的A项，使得这些项除以A余0, 1, 2, ..., A-1，所以我们能够从这A个连续项中找到除以A余1的数。再把这个数乘以a，则它的积除以A余a。这个除以A余a，同时能够被B\*C\*D\*...\*Z整除的数，为第一个数。

同理，我们能够从A\*C\*D\*...\*Z的倍数中找到除以B余b，同时能够被A\*C\*D\*...\*Z整除的数，为第二个数。

因为第一个数除以A余a，第二个数能被A整除，所以第一个数加上第二个数之和除以A余a。

同理，第一个数能被B整除，第二个数除以B余b，所以第一个数加第二个数之和除以B余b。

以此类推，按上面方法寻找到除以各素因子的余数的数之综合，为满足除以各素因子余数的条件。总和再减去能被这几个素数共同整除的数(A\*B\*C\*...\*Z)\*N之后，其差仍然保持除以各素因子余数的条件的数。由此构成中国剩余定理的解法。

## 实践

那么我们现在再来回顾一下一开始的问题

***"一个正整数M，除以3余2，除以5余3，除以7余2，究竟M最小为多少？"***

我们先计算5和7的最小公倍数LCM(5,7)=35，35的倍数中，除以3余1的数最小为`70`，70为第一个数。我们再计算LCM(3,7)=21，21的倍数中，除以5余1的数最小为`21`，21为第二个数。接着我们计算LCM(3,5)=15，15的倍数当中，除以7余1的数最小为`15`，15为第三个数。则他们乘以各自余数的总和为：

<center> 70\*2 + 21\*3 + 15\*2 = 233 </center>

那么233是符合条件的数，但它并不是最小，因为LCM(3,5,7)=105，即233加减任意倍的105都符合余数条件。所以最小的M为233除以105等于2余`23`。这个余数23是符合条件最小的M。
