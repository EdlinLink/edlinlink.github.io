---
layout: post
title:  "《这就是搜索引擎 核心技术详解》读书笔记"
date:   2015-03-24 12:00:00
tags:	tech
myTag:	algorithm

---

# 《这就是搜索引擎 核心技术详解》读书笔记

---------------------------------------------------

### 第二章 网络爬虫

### 2.4 抓取策略

在爬虫系统中，待抓取URL队列是很关键的部分，需要爬虫爬取的网页URL在其中顺序排列，形成一个队列结构，调度程序每次从队列头取出某个URL，发送给网页下载器下载页面内容，每个新下载的页面包含的URL会追加到待抓取URL队列的末尾，形成循环，整个爬虫系统由这个队列驱动运转的。

爬虫的不同爬取策略，是利用不同的方式确定待抓取URL队列中URL的优先顺序。抓取策略中，比较有代表性的解决方案有4种: 宽度优先便利策略、非完全PageRank策略、OCIP策略以及大站优先策略。

### 2.4.1 宽度优先遍历策略 (Breath First)

宽度优先遍历策略是一种简单直观而且历史悠久的遍历方法，在搜索引擎爬虫一出现就开始采用，新提出的爬取策略往往会将这种方法作为比较基准。值得注意的是，很多新的方法实际效果不见得比宽度优先遍历策略好，所以至今这种方法也是很多实际爬虫系统优先采用的爬取策略。

宽度优先策略就是`"将新下载网页包含的链接直接追加到待抓取的URL队列末尾"`。

实验表明这种策略效果很好，虽然看似机械，但实际上的网页抓取顺序基本是按照网页的重要性排序的。之所以如此，有研究人员认为：如果某个网页包含很多入链，那么更有可能被宽度优先遍历策略早早抓到，而入链个数从侧面体现了网页的重要性，即实际上宽度优先遍历策略隐含了一些网页优先级假设。

### 2.4.2 非完全PageRank策略 (Partial PageRank)

PageRank 可以用来衡量网页的重要性，可以想到用PageRank的思想来对URL优先级进行排序。但是PageRank是一个全局性算法，也就是当所有网页都下载完成后，其计算结果才是可靠的，而爬虫在爬取页面的过程中只能看到一部分页面，所以在抓取阶段的页面是无法得到可靠PageRank得分的。

但是我们可以在这个不完整的网页子集内计算PageRank。这就是非完全PageRank策略的基本思路: `对已下载的网页，加上待抓取URL队列中的URL一起，形成网页集合，在此集合内进行PageRank计算，计算完成后，将待抓取URL队列里的页面按照PageRank得分由高到低排序，形成的序列就是爬虫接下来应该依次爬取的URL列表。`这就是"非完全PageRank"策略。

如果每抓取一个页面就计算一次非完全PageRank值，明显效率太低，在现实中不可行。一个折中的办法是: 每当新下载K个页面后，再进行非完全PageRank的计算。但是这样又引来一个新的问题: 在展开下一轮PageRank计算之前，从新下载的页面抽取出包含的链接，很有可能这些链接的重要性非常高，理应优先下载。`非完全PageRank赋予这些新抽取出来但是又没有PageRank值的网页一个临时PageRank值，将这个网页的所有入链传导的PageRank值汇总，作为临时的PageRank值，如果这个值比待抓取URL队列中以及计算出来的PageRank值的网页高，那么优先下载这个URL`。

非完全PageRank看上去相对复杂，不同的实验结果有些表明非完全PageRank结果略优，有些结果则恰恰相反。更有研究人员指出: 非完全PageRank计算得出的重要性和完整的PageRank计算结果差异很大，不应作为衡量抓取过程中URL重要性的依据。

### 2.4.3 OCIP 策略 (Online Page Importance Computation)

OCIP可以看成是一种改进的PageRank算法。`在算法开始前，每个页面都给予相同的"现金"(cash)，每当下载某个页面P后，P将自己拥有的现金平均分配给页面中包含的链接页面，把自己的现金清空。而对于待抓取的URL队列中的页面，则根据其手头上拥有的现金金额多少排序，优先下载现金最充裕的页面。`OICP从大的框架和PageRank思路基本一直，区别在于: PageRank每次需要迭代计算，而OCIP策略不需要迭代过程，所以计算速度远远快语PageRank，适合实时计算使用。同时，PageRank在计算时，存在向无链接关系页面远程跳转的过程，而OCIP没有这一计算因子。实现结果证明，OCIP是中较好的重要性衡量策略，效果略优于宽度优先遍历策略。

### 2.4.4 大站优先策略 (Larger Sites First)

大站优先策略思路很直接: `以网站为单位衡量网页重要性，对于待抓取URL队列中的页面，根据所属网站归类，如果那个网站等待下载的页面最多，则优先下载这些链接。`其本质思想倾向于优先下载大型网站，因为大型网站往往包含更多的页面，鉴于大型网站往往是著名企业的内容，其网页质量一般较高，所以这个思路简单，但有一定依据。实现表明这个算法效果也要略优于宽度优先遍历策略。


